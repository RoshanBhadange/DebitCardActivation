pipeline {
    agent any
    stages {
        stage('Build') {
            steps {
                script {
                    def mvnHome = tool name: MVN_TOOL, type: 'maven'

                    def mvnCleanCmd = "${mvnHome}/bin/mvn clean"

                    sh mvnCleanCmd


                }

            }
        }
        stage('Test') {
            steps {
                echo 'Unit test'
            }
        }
        stage ('Run Script') {
            steps {
                 echo 'Run spark-submit command'
                                sh '''
                                    spark-submit \
                                        --class src/main/scala/DebitCardActivation.scala \
                                        --master yarn \
                                        --deploy-mode client \
                                        target/DebitCardActivation.jar
                                '''
            }

        }
    }
    post {
            success {
                echo 'Pipeline succeeded!'
            }
            failure {
                echo 'Pipeline failed!'
            }
        }

}